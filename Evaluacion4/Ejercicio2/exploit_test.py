# exploit.py
with open('cifrado1.bin', 'rb') as f1, open('cifrado2.bin', 'rb') as f2:
    c1 = f1.read()
    c2 = f2.read()
# El atacante obtiene C1 y C2 y calcula su XOR
xor_ciphers = bytes([b1 ^ b2 for b1, b2 in zip(c1, c2)])
# El atacante conoce o adivina el mensaje 1 (crib)
m1_conocido = b"Ataque a las 10:00 desde el norte de Maracaibo."
# Recupera el mensaje 2 haciendo XOR con el mensaje conocido
m2_recuperado = bytes([b1 ^ b2 for b1, b2 in zip(xor_ciphers, m1_conocido)])
print(f"Texto cifrado 1 (hex): {c1.hex()}")
print(f"Texto cifrado 2 (hex): {c2.hex()}")
print(f"XOR de cifrados (hex): {xor_ciphers.hex()}")
print("-" * 20)
print(f"Mensaje 2 recuperado: {m2_recuperado.decode(errors='ignore')}")
